[gcode_macro _CQGL]
gcode:
    {% if printer.quad_gantry_level.applied == False %}
        {% if "xyz" not in printer.toolhead.homed_axes %}
            RESPOND MSG="Homing"
            _CG28    
            UPDATE_DELAYED_GCODE ID=_CLEAR_DISPLAY DURATION=1  
        {% endif %}
            RESPOND MSG="Performing QGL"
            QUAD_GANTRY_LEVEL
            UPDATE_DELAYED_GCODE ID=_CLEAR_DISPLAY DURATION=1
            RESPOND MSG="Reset Z offset"
            G28 Z
            UPDATE_DELAYED_GCODE ID=_CLEAR_DISPLAY DURATION=1
    {% endif %}